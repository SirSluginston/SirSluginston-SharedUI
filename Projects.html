<!--
    SharedUI Projects Page
    - Modular, reusable, and future-proof (like a slug in a suit)
    - All content and branding injected/configured via JS and projects.json
    - If you break this, you owe SirSluginston a coffee
-->
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <script>
  // Insert ?project=SharedUI in the URL if missing, without reloading
    (function() {
      var params = new URLSearchParams(window.location.search);
      if (!params.has('project')) {
                params.set('project', 'SharedUI');
        var newUrl = window.location.pathname + '?' + params.toString();
        window.history.replaceState({}, '', newUrl);
      }
    })();
    </script>
    <!-- SharedUI core styles and config: don't touch unless you like chaos -->
    <link rel="stylesheet" href="SharedUI-border.css">
    <!-- All config is now loaded from projects.json. -->
    <link rel="stylesheet" href="variables.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects | SirSluginston Co</title>
    <!-- SharedUI component styles: keep it snazzy -->
  <link rel="stylesheet" href="SharedUI/Header/header.css">
  <link rel="stylesheet" href="SharedUI/Navbar/navbar.css">
  <link rel="stylesheet" href="SharedUI/Body/body.css">
  <link rel="stylesheet" href="SharedUI/Footer/footer.css">
  <link rel="stylesheet" href="SharedUI/ThemeToggle/theme-toggle.css">
  <link rel="stylesheet" href="SharedUI/Dropdown/dropdown.css">
  <link rel="stylesheet" href="SharedUI/Modals/modal.css">
  <link rel="stylesheet" href="SharedUI/Hero/hero.css">
  <link rel="stylesheet" href="SharedUI/ProjectCards/project-card.css">
</head>
<body>
  <!-- SharedUI JS: theme toggle, header, navbar, dropdown, modal -->
  <script src="SharedUI/sharedui.js"></script>
  <script src="SharedUI/ThemeToggle/theme-toggle.js"></script>
  <script src="SharedUI/Header/header.js"></script>
  <script src="SharedUI/Dropdown/dropdown.js"></script>
  <script src="SharedUI/Modals/modal.js"></script>
  <script src="SharedUI/Hero/hero.js"></script>
  <script src="SharedUI/ProjectCards/project-card.js"></script>
    <div class="sharedui-outer-border">
    <!-- SharedUI Header: top hat required -->
        <div id="header-container"></div>
    <!-- SharedUI Navbar: navigation for the truly lost -->
        <div id="site-navbar"></div>
    <!-- SharedUI Hero: page title and tagline -->
        <div id="shared-hero-container"></div>
    <!-- SharedUI Body: where the magic (and projects) happen -->
        <div id="body-container">
            <div class="shared-body">
                <div class="body-content" id="shared-body-content"></div>
            </div>
        </div>
        <!-- SharedUI Footer: the end, but also the beginning -->
        <div id="footer-container"></div>
    </div>
    <script>
      function initDropdownsAfterNavbar() {
        if (window.SharedUIDropdown) SharedUIDropdown.initAll();
        if (window.SharedUIModal) SharedUIModal.initAll();
      }
      (async function() {
        const { getProjects, injectHeader, injectFooter, applyBranding } = window.SharedUILib;
        const projects = await getProjects();
        const config = projects.find(p => (p.slug && p.slug.toLowerCase() === 'sharedui')) || projects[0];
        window.SharedUIConfig = config;
        applyBranding(config);
        injectHeader(config);
        injectFooter(config);
        var heroContainer = document.getElementById('shared-hero-container');
        var pageHref = window.location.pathname.split('/').pop() || 'Projects.html';
        var normPageHref = pageHref.endsWith('.html') ? pageHref.toLowerCase() : (pageHref + '.html').toLowerCase();
        var pageConfig = (config.pages || []).find(p => {
          if (!p.href) return false;
          var normHref = p.href.toLowerCase();
          return normHref === normPageHref || normHref.replace('.html','') === pageHref.toLowerCase().replace('.html','');
        });
        if (window.SharedUIHero && heroContainer && pageConfig) {
          SharedUIHero.inject(heroContainer, pageConfig.pageTitle, pageConfig.pageTagline);
        }
        var navbarScript = document.createElement('script');
        navbarScript.src = 'SharedUI/Navbar/navbar.js';
        navbarScript.onload = initDropdownsAfterNavbar;
        document.body.appendChild(navbarScript);
        // --- Dynamic project card rendering ---
        const content = document.getElementById('shared-body-content');
  let projectsArr = Array.isArray(projects) ? projects.filter(p => p.hasCard) : [];
        // Create a grid container for cards
        const grid = document.createElement('div');
        grid.className = 'projects-grid';
        for (const proj of projectsArr) {
          if (window.SharedUIProjectCard && typeof window.SharedUIProjectCard.render === 'function') {
            window.SharedUIProjectCard.render(grid, proj);
          }
        }
        content.innerHTML = '';
        content.appendChild(grid);
      })();
    </script>
